<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Soltra Pricing</title>
<link rel="stylesheet" href="styles.css" />
</head>

<body class="pricing-page">

<header class="pricing-header">
  <h1>Simple, Transparent Pricing</h1>
  <p>Start for free ‚Äî scale when you're ready.</p>
  <a href="index.html" class="back-link">‚Üê Back to home</a>
</header>

<section class="pricing-plans">
  <!-- FREE -->
  <div class="plan-card">
    <h2>Free</h2>
    <p class="price">$0 / month</p>
    <ul>
      <li>Up to <strong>5 contractors</strong></li>
      <li>Up to <strong>10 payouts / month</strong></li>
      <li>Base & Polygon only</li>
      <li>Basic support</li>
    </ul>
    <a href="app.html" class="plan-btn">Get Started</a>
  </div>

  <!-- PRO -->
  <div class="plan-card highlight">
    <h2>Pro</h2>
    <p class="price">$29 / month</p>
    <ul>
      <li><strong>Unlimited contractors</strong></li>
      <li><strong>Unlimited payouts</strong></li>
      <li>All chains supported</strong></li>
      <li>Priority email support</strong></li>
    </ul>
  
    <!-- üëá Add your Stripe Price ID here (example shown) -->
    <button
      class="plan-btn gold"
      data-price-id="price_1SjurWH8mH6Wr4HGWUeyezdC"
    >
      Upgrade
    </button>
  </div>


  <!-- ORG -->
  <div class="plan-card">
    <h2>Organization</h2>
    <p class="price">$99 / month</p>
    <ul>
      <li>Everything in Pro +</li>
      <li>Team accounts (coming soon)</li>
      <li>Onboarding assistance</li>
      <li>Quarterly check-ins</li>
    </ul>
    <button id="btn-org-checkout" class="plan-btn">Contact Sales</button>
  </div>
</section>
<script type="module">
  const proBtn = document.getElementById("btn-pro-checkout");

  if (proBtn) {
    proBtn.addEventListener("click", async () => {
      const priceId = proBtn.dataset.priceId;
      if (!priceId) {
        alert("Missing price ID on button.");
        return;
      }

      proBtn.disabled = true;
      const originalText = proBtn.textContent;
      proBtn.textContent = "Redirecting...";

      try {
        const res = await fetch(
          "https://lvuvkgnkhrzpwlssupyh.supabase.co/functions/v1/create-checkout-session",
          {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ priceId }),
          }
        );

        console.log("Checkout response status:", res.status);

        const data = await res.json().catch(() => ({}));
        console.log("Checkout response body:", data);

        if (!res.ok) {
          throw new Error(data.error || `HTTP ${res.status}`);
        }

        if (!data.url) {
          throw new Error("No URL returned from checkout function");
        }

        // ‚úÖ Redirect to Stripe Checkout
        window.location.href = data.url;
      } catch (err) {
        console.error("Checkout error:", err);
        alert("Something went wrong starting checkout. Check console for details.");
      } finally {
        proBtn.disabled = false;
        proBtn.textContent = originalText;
      }
    });
  }
</script>


</body>
</html>

