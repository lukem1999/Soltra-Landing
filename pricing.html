<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Soltra Pricing</title>
<link rel="stylesheet" href="styles.css" />
</head>

<body class="pricing-page">

<header class="pricing-header">
  <h1>Simple, Transparent Pricing</h1>
  <p>Start for free ‚Äî scale when you're ready.</p>
  <a href="index.html" class="back-link">‚Üê Back to home</a>
</header>

<section class="pricing-plans">
  <!-- FREE -->
  <div class="plan-card">
    <h2>Free</h2>
    <p class="price">$0 / month</p>
    <ul>
      <li>Up to <strong>5 contractors</strong></li>
      <li>Up to <strong>10 payouts / month</strong></li>
      <li>Base & Polygon only</li>
      <li>Basic support</li>
    </ul>
    <a href="app.html" class="plan-btn">Get Started</a>
  </div>

  <!-- PRO -->
  <div class="plan-card highlight">
    <h2>Pro</h2>
    <p class="price">$29 / month</p>
    <ul>
      <li><strong>Unlimited contractors</strong></li>
      <li><strong>Unlimited payouts</strong></li>
      <li>All chains supported</strong></li>
      <li>Priority email support</strong></li>
    </ul>
  
    <!-- üëá Add your Stripe Price ID here (example shown) -->
    <button
      class="plan-btn gold"
      data-price-id="prod_ThJUNMwRDRfwLi"
    >
      Upgrade
    </button>
  </div>


  <!-- ORG -->
  <div class="plan-card">
    <h2>Organization</h2>
    <p class="price">$99 / month</p>
    <ul>
      <li>Everything in Pro +</li>
      <li>Team accounts (coming soon)</li>
      <li>Onboarding assistance</li>
      <li>Quarterly check-ins</li>
    </ul>
    <button id="btn-org-checkout" class="plan-btn">Contact Sales</button>
  </div>
</section>
<script>
  // Supabase Edge Function endpoint for Stripe checkout
  const CHECKOUT_ENDPOINT =
    "https://lvuvkgnkhrzpwlssupyh.functions.supabase.co/create-checkout-session";

  async function startCheckout(priceId, button) {
    if (!priceId) {
      console.error("Missing priceId on button");
      return;
    }

    const originalText = button.textContent;
    button.disabled = true;
    button.textContent = "Redirecting‚Ä¶";

    try {
      const res = await fetch(CHECKOUT_ENDPOINT, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ priceId }),
      });

      const data = await res.json();

      if (!res.ok || !data.url) {
        console.error("Checkout error:", data);
        alert(data.error || "Could not start checkout. Please try again.");
        button.disabled = false;
        button.textContent = originalText;
        return;
      }

      // üîÅ Redirect to Stripe-hosted checkout page
      window.location.href = data.url;
    } catch (err) {
      console.error("Network/JS error starting checkout:", err);
      alert("Something went wrong starting checkout. Please try again.");
      button.disabled = false;
      button.textContent = originalText;
    }
  }

  // Wire up all buttons that have a data-price-id
  document.addEventListener("DOMContentLoaded", () => {
    const upgradeButtons = document.querySelectorAll("[data-price-id]");

    upgradeButtons.forEach((btn) => {
      btn.addEventListener("click", (e) => {
        e.preventDefault();
        const priceId = btn.dataset.priceId;
        startCheckout(priceId, btn);
      });
    });
  });
</script>


</body>
</html>

